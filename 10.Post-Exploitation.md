<p align="center">
    <img src="LogoBiggerBW.png" alt="BPM Circuits" width="300" />
</p>

<p align="center">
  eJPT-CheatSheets<br>
  Bartosz Pokrywka
</p>

<p align="center">
    Usefull info and commands for eJPT cert exam
</p>

# Windows Enumeration

## Enumerating System Information

### In meterpreter:

    > getuid

    > sysinfo

### In shell:

    > hostname

Command to enumerate all usefull info:

    > systeminfo

Enumerate HotFixes and different interesting things that systeminfo can't:

    > wmic qfe get Caption,Description,HotFixID,InstalledOn

Sometimes there's a file called:

    > C:\\Windows\System32\eula.txt

## Enumerating Users & Groups

### In metasploit-framework:

    > getuid

    > getprivs

    > use enum_logged_on_users

### In shell:

    > whoami

    > whoami /priv

List currently logged on users:

    > query user

Identyfiy users on system:

    > net users

To learn about particullar user:

    > net user <USER>

Enumerate groups on system:

    > net localgroup

Identyfiy users of the group:

    > net localgroup <GROUP>

## Enumerating Network Information

Windows IP Configuration:

    > ipconfig

    > ipconfig /all

Routing table:

    > route print

Other systems on the network

    > arp -a

Display open connections, services running:

    > netstat -ano

Windows firewall configuration:

    > netsh firewall show state

    > netsh advfirewall 

## Enumerating Processes & Services

### Meterpreter

Process list:

    > ps

Search for process name:

    > pgrep <processName>

Migrate to a specified process:

    > migrate <processID>

### Shell

List of started services:

    > net start

Display all services:

    > wmic service list brief

List of processes and the respective services:

    > tasklist /SVC

List of scheduled tasks:

    > schtasks /query /fo LIST /v

## Automating Windows Local Enumeration

### Meterpreter

    > use post/windows/gather/win_privs

    > use post/windows/gather/enum_logged_on_users

    > use post/windows/gather/checkvm

    > use post/windows/gather/enum_applications

    > use post/windows/gather/enum_computers

    > use post/windows/gather/enum_patches

    > use post/windows/gather/enum_shares

### JAWS

- JAWS - Just Another Windows (Enum) Script

- GitHub Repo: https://github.com/411Hall/JAWS

In shell:

    > powershell.exe -ExecutionPolicy Bypass -File .\jaws-enum.ps1 -OutputFilename JAWS-Enum.txt

# Linux Enumeration

## Enumerating System Information

### Meterpreter

    > sysinfo

### Shell

Current dir:

    > pwd

Host name:

    > hostname

Distribution:

    > cat /etc/issue

Name and release:

    > cat /etc/*release

Kernel version:

    > uname -r

    more info:

    > uname -a

Enviroment variables:

    > env

Hardware resources:

    > lscpu

How much RAM is being consumed:

    > free -h

Disk space:

    > df -h

Another command:

    > lsblk | grep sd

If target system is debian, you can list installed packages:

    > dpkg -l

## Enumerating Users & Groups

### Meterpreter

Get username and group:

    > getuid

### Shell

Get username:

    > whoami

Get group:

    > groups <username>

Get other users on the system:

    > cat /etc/passwd

Find only user accounts (that you can login into):

    > cat /etc/passwd | grep -v /nologin

To add user to a specified group:

    > usermod -aG <group> <user>

List currently logged on users:

    > w

    > who

    > last

    > lastlog

## Enumerating Network Information

### Meterpreter

Network config: 

    > ifconfig

Connection list:

    > netstat

Network routes:

    > route

ARP:

    > arp

### Shell

Network config:

    > ip a s

Contents of the network file:

    > cat /etc/networks

Hostname:

    > cat /etc/hostname

Hosts file:

    > cat /etc/hosts

Display DNS info:

    > cat /etc/resolv.conf

## Enumerating Processes & Services

### Meterpreter

List of processes:

    > ps

Look for PID number of process:

    > pgrep <processName>

Migrate to desired process PID

    > migrate <PID>

### Shell:

List of processes:

    > ps aux

    > ps aux | grep <processName>

List of processes live view:

    > top

List cron jobs

    > ls -al /etc/cron*

Show cron file

    > cat /etc/cron

## Automating Linux Local Enumeration

### Metasploit

    > use /post/linux/gather/enum_configs

    > use /post/linux/gather/enum_network

    > use /post/linux/gather/enum_system

    > use /post/linux/gather/checkvm

### LinEnum & linPEAS

- LinEnum is a simple bash script that automates common Linux local enumeration checks in addition to indentifying privilege escalation vulnerabilities.

- GitHub Repo: https://github.com/rebootuser/LinEnum

I like more linPEAS:

- linPEAS - Linux Privilege Escalation Awesome Script

- GitHub Repo: https://github.com/peass-ng/PEASS-ng/tree/master/linPEAS

Also for Windows! :)







